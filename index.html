<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" ng-app="app"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
        <link href='http://fonts.googleapis.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Quattrocento' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=IM+Fell+Double+Pica:400italic' rel='stylesheet' type='text/css'>
        <link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
        <link rel="stylesheet" href="css/fonts/sssocial.css">
        <link rel="stylesheet" href="css/fonts/ssstandard.css">
        <link rel="stylesheet" href="css/transitions.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/isotope.css">
        <link rel="stylesheet" href="css/override.css">
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <div class="container">
            <div class="row">
                <div class="span2">
                    <a href="#" id="tag" class="rectangle"><img src="images/tag.png"></a>
                </div>
            </div>
        </div>

        <div class="container" style="display:none;">
	        <div class="row">
		        <div class="span12">
			        <div class="btn-toolbar">
					  <ul id="options" class="option-set btn-group">
					    <li class="btn" data-type="original">Original Order</li>
					    <li class="btn" data-type="name">Name</li>
					    <li class="btn" data-type="category">Category</li>
					    <li class="btn" data-type="random">Random</li>
					  </ul>
					</div>
				</div>
	        </div>
        </div>
        
        <!-- Veil Code -->
        <div class="fixed veil" id="veil">
        	<div class="container">
	        	<div class="row">
		        	<div class="span12 text-center">
                        <div class="inner-wrapper">
                            <div  class="logo-big">
                                <img src="images/10yr.png">
                            </div>
    			        	<h1>Ten Years of Rectangles</h1>
                            <p>
                                Aerobic brewpub fermentation, ibu wit. Hops priming noble hops aroma hops lauter tun barrel? Trappist; hydrometer brewhouse scotch ale copper autolysis infusion krug? Black malt carboy conditioning wort chiller. Gravity malt brewing mead finishing hops mash. Pint glass degrees plato brewhouse, units of bitterness.
                            </p>
                            <div  class="logo-small">
                                <img src="images/keystone.png">
                            </div>
                        </div>
                        <div class="credits-wrapper">
                            <h3>Another fine project from</h3>
                            <span class="logo">The Heads <em>of</em> State</span>
                        </div>
                        <div class="bottom-dismiss-wrapper">
                            <a href="#" id="dismiss-veil"><i class="icon-chevron-down"></i></a>
                        </div>
		        	</div>
	        	</div>
        	</div>
	        
        </div>
        
        <div class="container" style="height: 100%; margin-top: 50px; position: relative;">
        	<div class="row">
	        	<div class="span2 left-nav" id="left-nav">
                    <div class="inner-nav-wrapper-left">
                        <a id="scroll-top" class="ss-navigateup ss-icon"></a>
                        <a id="four-col" class="ss-microsoft ss-icon ss-social-regular"></a>
                        <a id="two-col" class="ss-pause ss-icon"></a>
                        <a id="sample" class="ss-sample ss-icon"></a>
                        <a id="red" class="color-icon color-icon-red" data-color="red"></a>
                        <a id="black" class="color-icon color-icon-black" data-color="black" href="#"></a>
                        <a id="yellow" class="color-icon color-icon-yellow" data-color="yellow" href="#"></a>
                        <a id="green" class="color-icon color-icon-green" data-color="green" href="#"></a>
                        <a id="blue" class="color-icon color-icon-blue" data-color="blue" href="#"></a>
                        <a id="orange" class="color-icon color-icon-orange" data-color="orange" href="#"></a>
                        <a id="white" class="color-icon color-icon-white" data-color="white" href="#"></a>
                        <a id="purple" class="color-icon color-icon-purple" data-color="purple" href="#"></a>
                        <a id="pink" class="color-icon color-icon-pink" data-color="pink" href="#"></a>
                        <a id="brown" class="color-icon color-icon-brown" data-color="brown" href="#"></a>
                        <a id="grey" class="color-icon color-icon-grey" data-color="grey" href="#"></a>
                    </div>
	        	</div>
	        	<div class="span8">
		        	<div id="masonry" class="row masonry four-col" ng-controller="RectangleController">

                    </div>
	        	</div>
	        	<div class="span2 right-nav" id="right-nav">
		        	<div class="inner-nav-wrapper-right">
                        <a class="ss-facebook ss-icon ss-social-regular" href="http://www.facebook.com/share.php?u=http://tenyearsofrectangles.com" target="_blank"></a>
                        <a class="ss-twitter ss-icon ss-social-regular" href="https://twitter.com/intent/tweet?original_referer=http://tenyearsofrectangles.com&amp;url=http://tenyearsofrectangles.com&amp;source=tweetbutton"></a>
                        <a class="ss-instagram ss-icon ss-social-regular"></a>
                        <a class="hos-menu-icon" href="http://theheadsofstate.com/" target="_blank"></a>
                    </div>
	        	</div>
        	</div>
        </div>

        <nav id="page_nav" style="display:none;">
          <a href="2.html"></a>
        </nav>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script>
        <script src="js/jquery.isotope.min.js"></script>
        <script src="js/jquery.infinitescroll.min.js"></script>
		<script src="js/fonts/ss-social.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
		
		<script>
		    var $container = $('#masonry');
		    var veilVisible = true;
		    
            var app = angular.module('app', []);

            app.controller('RectangleController', [
                '$scope',
                function($scope) {
                    var images = [];
                    $.ajax({
                      type: "GET",
                      url: "http://hos001.s3.amazonaws.com/",
                      dataType: "xml",
                      success: function(data, status, xhr){
                        $(data).find('Key').each(function(){
                           var item = $(this).text();
                           var end = item.substring(item.length - 4);
                           if(end == ".png"){
                               images.push(item);
                               $('#masonry').append('<div class="photo span2 rectangle" data-category="cat1" id="'+item+'"><img src="http://hos001.s3.amazonaws.com/'+item+'"/></div>');
                               $('#page_nav').append('<div class="photo span2 rectangle" data-category="cat1"><img src="http://hos001.s3.amazonaws.com/'+item+'"/></div>');
                           }
                        });
                    refreshIsotope();
                    img = {
                        red:    ["original/8_London_Guardian.png", 
                                "original/McKinsey_africa_final.png",
                                "original/aarp_dollargift.png",
                                "original/altlantic_montly_final.png",
                                "original/audubon_final_small.png",
                                "original/bookreview_cicero.png",
                                "original/dallas_rowers_final.png",
                                "original/deliver_final_flat.png",
                                "original/decisions_jan_final.png",
                                "original/fastco_china_final.png",
                                "original/globe_color_flat.png",
                                "original/flag_texture.png",
                                "original/nike-final.png",
                                "original/nyt_crossbones_final.png",
                                "original/nyt_innovate.png",
                                "original/screws_flat.png"],
                        black:  ["original/8_London_Guardian.png", 
                                "original/Philly_bino2.png",
                                "original/aarp_dollargift.png",
                                "original/altlantic_montly_final.png",
                                "original/cio_eyeblinds_final_flat.png",
                                "original/audubon_final_small.png",
                                "original/bookreview_cicero.png",
                                "original/deliver_final_flat.png",
                                "original/globesnake_final.png",
                                "original/flag_texture.png",
                                "original/fortune_map_final.png",
                                "original/mensjournal_wheel_final.png",
                                "original/men's_health_metrogrades_final.png",
                                "original/nyt_crossbones_final.png",
                                "original/nyt_bombsFinalflat.png",
                                "original/nyt_hands.png",
                                "original/oped_eagle_final_frame.png",
                                "original/oped_cloud_flag_short_scan.png",
                                "original/realsimple_tightrope_final.png",
                                "original/realsimple_drown.png",
                                "original/spinfinal.png",
                                "original/zoetrope_final.png",
                                "original/oped_shopping_cart.png"],
                        yellow: ["original/McKinsey_africa_final.png",
                                 "original/men's_health_metrogrades_final.png",
                                 "original/nyt_innovate.png",
                                 "original/spinfinal.png"],
                        green:  ["original/McKinsey_africa_final.png",
                                 "original/audubon_final_small.png",
                                 "original/decisions_jan_final.png",
                                 "original/flag_texture.png",
                                 "original/nyt_crossbones_final.png",
                                 "original/nyt_innovate.png",
                                 "original/ptsd_helmetfinal.png",
                                 "original/zoetrope_final.png"],
                        orange: ["original/Philly_bino2.png",
                                "original/mensjournal_wheel_final.png",
                                "original/nyt_innovate.png"],
                        blue:   ["original/Philly_bino2.png",
                                 "original/cookie.png",
                                 "original/dallas_rowers_final.png",
                                 "original/decisions_jan_final.png",
                                 "original/fastco_china_final.png",
                                 "original/globesnake_final.png",
                                 "original/flag_texture.png",
                                 "original/menshealth_final2.png",
                                 "original/nyt_innovate.png",
                                 "original/ogilvy_magnolia_flat.png",
                                 "original/realsimple_drown.png",
                                 "original/screws_flat.png"],
                        white:  ["original/aarp_dollargift.png",
                                 "original/altlantic_montly_final.png",
                                 "original/cio_eyeblinds_final_flat.png",
                                 "original/dallas_rowers_final.png",
                                 "original/globe_color_flat.png",
                                 "original/fortune_map_final.png",
                                 "original/mensjournal_wheel_final.png",
                                 "original/menshealth_final2.png",
                                 "original/nyt_bombsFinalflat.png",
                                 "original/nyt_hands.png",
                                 "original/oped_eagle_final_frame.png",
                                 "original/oped_cloud_flag_short_scan.png",
                                 "original/oped_ehrenreich_2A.png",
                                 "original/ogilvy_magnolia_flat.png",
                                 "original/realsimple_tightrope_final.png",
                                 "original/screws_flat.png",
                                 "original/oped_shopping_cart.png"],
                        purple: ["original/cio_eyeblinds_final_flat.png",
                                 "original/realsimple_tightrope_final.png"],
                        pink:   ["original/cookie.png"],
                        brown:  ["original/nike-final.png",
                                 "original/ptsd_helmetfinal.png"],
                        grey:   ["original/oped_cloud_flag_short_scan.png",
                                 "original/oped_ehrenreich_2A.png",
                                 "original/ogilvy_magnolia_flat.png",
                                 "original/ptsd_helmetfinal.png"]
                    }

                        var isIn = function(val, array) {
                            var inArray = false;
                            array.forEach(function(item) {
                                if (val == item) {
                                    inArray = true;
                                };
                            });
                            return inArray;
                        };

                        var unique = function(array) {
                            var unique = [];

                            array.forEach(function (value) {
                                if (unique.indexOf(value) === -1) {
                                    unique.push(value);
                                }
                            });

                            return unique;
                        }

                        $('.color-icon').on('click', function() {
                            var c = $(this).attr('data-color');
                            
                            var p = $('.photo').filter(function(){
                                return isIn(this.id, img[c]);
                            });

                            $('.photo').remove();
                            $('#masonry').append(p);
                            $container.isotope('reLayout');
                        });

                      }
                    });
                }]);        
		    
		    $('#tag').animate({'top':-$('#tag').height() - 10});
		    
		    function refreshIsotope(){
		      $container.imagesLoaded( function(){
		        $container.isotope({
		          itemSelector : '.photo',
		          getSortData : {
			          category : function ($elem){
				          return $elem.attr('data-category');
			          }
		          }
		        });
		      });    
		    }

            //binding to mousewheel for the scrolling functions
            $(window).bind('mousewheel', function (e) {
                var scrollTop = $(window).scrollTop();
                
                if(veilVisible){
                    
                    // variable to account for the user being already scrolled down - accounts for the 'fixed' positioning relationship.
                    var realTop = $('#veil').position().top - scrollTop;
                    
                    // make sure that moving the veil doesn't put it in an inappropriate location
                    if((-scrollTop * 5) <= 0 && $('#veil').position().top < $('#veil').height())
                    {
                        // move the veil, in parallax to the window (less than is scrolled)
                        $('#veil').css('top', (-scrollTop * 5) + 'px');  
                    }
                    if($('#veil').position().top < -$('#veil').height()){
                        $('#tag').animate({'top':0});
                        veilVisible= false;
                        
                    }
                }      
            });

            $(window).resize(function() {
                $container.isotope('reLayout');
            });

            $('#scroll-top').on('click', function(e) {
                e.preventDefault();
                $(window).scroll(0);
            });

            $('#dismiss-veil').on('click', function(e) {
                e.preventDefault();
                toggleVeilTag();
            });

            $('#tag').on('click', function(e) {
                
                // prevent the default # anchor behavior
                e.preventDefault();
                toggleVeilTag();
                
            });
            
            function toggleVeilTag(){
                var veil = $('#veil');
                
                // Simple toggle switch 
                if(!veilVisible){
                    
                    //Show the veil
                    $('#veil').animate({'top': 0});
                    $('#tag').animate({'top':-$('#tag').height() - 10});
                    veilVisible = true;
                } else {
                    
                    // Hide the veil
                    $('#veil').animate({'top': -$('#veil').height()});
                    $('#tag').animate({'top':0});
                    veilVisible = false;
                }
            }
 
            function parallaxScroll(){
                var scrolled = $(window).scrollTop();
                if($('.veil').position().top >= (0-(scrolled*15)) ){
                    $('.veil').css('top',(0-(scrolled*15))+'px');
                }
            }
		    
		    $(function(){

				$('#two-col').on('click', function(){
                    $('#masonry').addClass('fadeOutUp animated');
                    setTimeout(function () {
                        $('#masonry').addClass('two-col');
                        $('#masonry').removeClass('four-col');
                        refreshIsotope();
                    }, 800);
                    setTimeout(function () {
                        $('#masonry').removeClass('fadeOutUp');
                        $('#masonry').removeClass('animated');
                        $('#masonry').addClass('fadeInDown animated');
                    }, 1500);
				});

                $('#four-col').on('click', function(){
                    $('#masonry').addClass('fadeOutUp animated');
                    setTimeout(function () {
                        $('#masonry').removeClass('two-col');
                        $('#masonry').addClass('four-col');
                        refreshIsotope();
                    }, 800);
                    setTimeout(function () {
                        $('#masonry').removeClass('fadeOutUp');
                        $('#masonry').removeClass('animated');
                        $('#masonry').addClass('fadeInDown animated');
                    }, 1500);
                });

                var removeItem = function(el, arr) {
                    i = arr.indexOf(el);
                    arr.forEach(function(e) {
                        if (i != -1) {
                            arr.splice(i, 1);
                        }
                    });
                };

                $('#sample').on('click', function() {
                    var switcher = ['none', 'block'];
                    var current = $('.color-icon').css('display');
                    removeItem(current, switcher);
                    $('.color-icon').css('display', switcher[0]);
                });
			
		        //refreshIsotope();
			  
  			    $('#options .btn').on('click', function(){
  				    value = $(this).attr('data-type');
  				    $container.isotope( {sortBy: value} );
  			    });
      
                $container.infinitescroll({
                    dataType: 'html',
                    navSelector  : '#page_nav',    // selector for the paged navigation 
                    nextSelector : '#page_nav a',  // selector for the NEXT link (to page 2)
                    itemSelector : '.photo',     // selector for all items you'll retrieve
                    loading: {
                        finishedMsg: 'No more pages to load.',
                        img: 'http://i.imgur.com/qkKy8.gif'
                      }
                    },
                    // call Isotope as a callback
                    function( newElements ) {
                      $container.isotope( 'appended', $( newElements ) );
                    }
                  );
			  
		        });

		  </script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
    </body>
</html>
